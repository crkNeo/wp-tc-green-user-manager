<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TCross è¨»å†Šè¦–çª—æ¸¬è©¦</title>
    <link rel="stylesheet" href="assets/css/registration-modal.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .test-form {
            background: #f9f9f9;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-group input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .user-type-buttons {
            display: flex;
            gap: 15px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .user-type-btn {
            padding: 12px 25px;
            border: 2px solid #0073aa;
            background: #fff;
            color: #0073aa;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .user-type-btn:hover {
            background: #0073aa;
            color: white;
        }
        
        .user-type-btn.selected {
            background: #0073aa;
            color: white;
        }
        
        .register-btn {
            background: #46b450;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .register-btn:hover {
            background: #369e3f;
        }
        
        .info-box {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .success-box {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        @media (max-width: 480px) {
            .user-type-buttons {
                flex-direction: column;
            }
            
            .user-type-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§ª TCross è¨»å†Šç¢ºèªè¦–çª—æ¸¬è©¦</h1>
        
        <div class="info-box">
            <strong>æ¸¬è©¦èªªæ˜ï¼š</strong>
            <p>é€™æ˜¯ä¸€å€‹ç¨ç«‹çš„æ¸¬è©¦é é¢ï¼Œç”¨ä¾†é©—è­‰è¨»å†Šç¢ºèªè¦–çª—çš„åŠŸèƒ½ã€‚è«‹æŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿæ¸¬è©¦ï¼š</p>
            <ol>
                <li>é¸æ“‡è¨»å†Šé¡å‹ï¼ˆéœ€æ±‚å–®ä½æˆ–ç¶ ç…§å¸«ï¼‰</li>
                <li>é»æ“Šè¨»å†ŠæŒ‰éˆ•</li>
                <li>æŸ¥çœ‹ç¢ºèªè¦–çª—æ˜¯å¦æ­£ç¢ºé¡¯ç¤º</li>
                <li>æ¸¬è©¦ç¢ºèªå’Œå–æ¶ˆåŠŸèƒ½</li>
            </ol>
        </div>

        <div class="test-form">
            <h3>æ¨¡æ“¬è¨»å†Šè¡¨å–®</h3>
            
            <div class="form-group">
                <label for="username">ç”¨æˆ¶åç¨±</label>
                <input type="text" id="username" name="username" placeholder="è«‹è¼¸å…¥ç”¨æˆ¶åç¨±" value="æ¸¬è©¦ç”¨æˆ¶">
            </div>
            
            <div class="form-group">
                <label for="email">é›»å­éƒµä»¶</label>
                <input type="email" id="email" name="email" placeholder="è«‹è¼¸å…¥é›»å­éƒµä»¶" value="test@example.com">
            </div>
            
            <div class="form-group">
                <label for="password">å¯†ç¢¼</label>
                <input type="password" id="password" name="password" placeholder="è«‹è¼¸å…¥å¯†ç¢¼" value="123456">
            </div>

            <div class="form-group">
                <label>é¸æ“‡è¨»å†Šé¡å‹</label>
                <div class="user-type-buttons">
                    <button type="button" class="user-type-btn" data-type="demand_unit">
                        è¨»å†Šéœ€æ±‚å–®ä½
                    </button>
                    <button type="button" class="user-type-btn" data-type="green_teacher">
                        è¨»å†Šç¶ ç…§å¸«
                    </button>
                </div>
                <div id="type-selection-error" style="color: red; display: none;">è«‹é¸æ“‡è¨»å†Šé¡å‹</div>
            </div>

            <input type="hidden" id="tcross-user-type" name="tcross_user_type" value="">

            <button type="button" class="register-btn" id="test-register-btn">è¨»å†Š</button>
        </div>

        <div class="warning-box">
            <strong>æ³¨æ„ï¼š</strong>é€™æ˜¯æ¸¬è©¦é é¢ï¼Œä¸æœƒåŸ·è¡ŒçœŸæ­£çš„è¨»å†Šæ“ä½œï¼Œåƒ…ç”¨æ–¼æ¸¬è©¦è¦–çª—é¡¯ç¤ºæ•ˆæœã€‚
        </div>

        <div class="test-container">
            <h3>å…¶ä»–æ¸¬è©¦åŠŸèƒ½</h3>
            <p>
                <button type="button" class="register-btn" onclick="showTestModal()">ç›´æ¥é¡¯ç¤ºæ¸¬è©¦è¦–çª—</button>
                <button type="button" class="user-type-btn" onclick="showCustomModal()" style="margin-left: 10px;">è‡ªå®šç¾©å…§å®¹æ¸¬è©¦</button>
            </p>
            
            <div id="test-results" style="margin-top: 20px;"></div>
        </div>
    </div>

    <!-- è¨»å†Šç¢ºèªè¦–çª— -->
    <div id="tcross-registration-modal" class="tcross-registration-modal">
        <div class="tcross-modal-content">
            <div class="tcross-modal-header">
                <h3 id="tcross-modal-title">è¨»å†Šç¢ºèª</h3>
                <span class="tcross-modal-close">&times;</span>
            </div>
            <div class="tcross-modal-body">
                <div id="tcross-modal-content">
                    <h4>è«‹ä»”ç´°é–±è®€ä»¥ä¸‹æ³¨æ„äº‹é …ï¼š</h4>
                    <ul>
                        <li>è«‹ç¢ºä¿æ‚¨æä¾›çš„è³‡æ–™çœŸå¯¦æœ‰æ•ˆ</li>
                        <li>è¨»å†Šå¾Œæ‚¨å°‡æ”¶åˆ°ç¢ºèªéƒµä»¶ï¼Œè«‹æª¢æŸ¥æ‚¨çš„ä¿¡ç®±</li>
                        <li>å¦‚æœ‰ä»»ä½•å•é¡Œï¼Œè«‹è¯ç¹«å®¢æœäººå“¡</li>
                        <li>è¨»å†Šå³è¡¨ç¤ºæ‚¨åŒæ„æˆ‘å€‘çš„æœå‹™æ¢æ¬¾å’Œéš±ç§æ”¿ç­–</li>
                    </ul>
                    <p><strong>ç¢ºèªå¾Œå°‡å®Œæˆè¨»å†Šç¨‹åºã€‚</strong></p>
                </div>
            </div>
            <div class="tcross-modal-footer">
                <button type="button" class="tcross-modal-btn tcross-modal-btn-cancel" id="tcross-modal-cancel">å–æ¶ˆ</button>
                <button type="button" class="tcross-modal-btn tcross-modal-btn-confirm" id="tcross-modal-confirm">ç¢ºèªè¨»å†Š</button>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ“¬ jQueryï¼ˆç°¡åŒ–ç‰ˆï¼‰
        if (typeof jQuery === 'undefined') {
            window.jQuery = window.$ = function(selector) {
                if (typeof selector === 'function') {
                    document.addEventListener('DOMContentLoaded', selector);
                    return;
                }
                
                let elements = [];
                if (typeof selector === 'string') {
                    elements = Array.from(document.querySelectorAll(selector));
                } else if (selector.nodeType) {
                    elements = [selector];
                }
                
                elements.on = function(event, handler) {
                    elements.forEach(el => el.addEventListener(event, handler));
                    return elements;
                };
                
                elements.addClass = function(className) {
                    elements.forEach(el => el.classList.add(className));
                    return elements;
                };
                
                elements.removeClass = function(className) {
                    elements.forEach(el => el.classList.remove(className));
                    return elements;
                };
                
                elements.val = function(value) {
                    if (value !== undefined) {
                        elements.forEach(el => el.value = value);
                        return elements;
                    }
                    return elements[0] ? elements[0].value : '';
                };
                
                elements.text = function(text) {
                    if (text !== undefined) {
                        elements.forEach(el => el.textContent = text);
                        return elements;
                    }
                    return elements[0] ? elements[0].textContent : '';
                };
                
                elements.html = function(html) {
                    if (html !== undefined) {
                        elements.forEach(el => el.innerHTML = html);
                        return elements;
                    }
                    return elements[0] ? elements[0].innerHTML : '';
                };
                
                elements.css = function(prop, value) {
                    if (typeof prop === 'object') {
                        elements.forEach(el => Object.assign(el.style, prop));
                    } else if (value !== undefined) {
                        elements.forEach(el => el.style[prop] = value);
                    }
                    return elements;
                };
                
                elements.show = function() {
                    elements.forEach(el => el.style.display = '');
                    return elements;
                };
                
                elements.hide = function() {
                    elements.forEach(el => el.style.display = 'none');
                    return elements;
                };
                
                elements.data = function(key, value) {
                    if (value !== undefined) {
                        elements.forEach(el => el.dataset[key] = value);
                        return elements;
                    }
                    return elements[0] ? elements[0].dataset[key] : undefined;
                };
                
                return elements;
            };
        }

        // åˆå§‹åŒ–æ¸¬è©¦åŠŸèƒ½
        $(function() {
            console.log('TCross è¨»å†Šè¦–çª—æ¸¬è©¦é é¢è¼‰å…¥å®Œæˆ');
            
            // ç”¨æˆ¶é¡å‹é¸æ“‡
            $('.user-type-btn').on('click', function() {
                $('.user-type-btn').removeClass('selected');
                $(this).addClass('selected');
                $('#tcross-user-type').val($(this).data('type'));
                $('#type-selection-error').hide();
                
                logTest('é¸æ“‡ç”¨æˆ¶é¡å‹: ' + $(this).data('type'));
            });
            
            // æ¨¡æ…‹è¦–çª—é—œé–‰
            $('.tcross-modal-close, #tcross-modal-cancel').on('click', function() {
                hideModal();
            });
            
            // ç¢ºèªè¨»å†Š
            $('#tcross-modal-confirm').on('click', function() {
                confirmRegistration();
            });
            
            // è¨»å†ŠæŒ‰éˆ•
            $('#test-register-btn').on('click', function() {
                var userType = $('#tcross-user-type').val();
                
                if (!userType) {
                    $('#type-selection-error').show().text('è«‹å…ˆé¸æ“‡è¨»å†Šé¡å‹');
                    logTest('éŒ¯èª¤: æœªé¸æ“‡ç”¨æˆ¶é¡å‹', 'error');
                    return;
                }
                
                logTest('æ””æˆªè¨»å†Šè¡¨å–®ï¼Œé¡¯ç¤ºç¢ºèªè¦–çª—');
                showModal();
            });
            
            // ESC éµé—œé–‰
            $(document).on('keydown', function(e) {
                if (e.key === 'Escape' && $('#tcross-registration-modal').hasClass('show')) {
                    hideModal();
                }
            });
            
            // é»æ“ŠèƒŒæ™¯é—œé–‰
            $('#tcross-registration-modal').on('click', function(e) {
                if (e.target === this) {
                    hideModal();
                }
            });
        });
        
        function showModal() {
            $('#tcross-registration-modal').addClass('show');
            $('body').css('overflow', 'hidden');
            logTest('é¡¯ç¤ºè¨»å†Šç¢ºèªè¦–çª—');
        }
        
        function hideModal() {
            $('#tcross-registration-modal').removeClass('show').addClass('closing');
            setTimeout(function() {
                $('#tcross-registration-modal').removeClass('closing');
                $('body').css('overflow', '');
            }, 300);
            logTest('é—œé–‰è¨»å†Šç¢ºèªè¦–çª—');
        }
        
        function confirmRegistration() {
            logTest('ç”¨æˆ¶ç¢ºèªè¨»å†Š');
            $('#tcross-modal-confirm').text('è™•ç†ä¸­...').css('opacity', '0.7');
            
            setTimeout(function() {
                hideModal();
                showSuccessMessage();
                $('#tcross-modal-confirm').text('ç¢ºèªè¨»å†Š').css('opacity', '1');
            }, 1500);
        }
        
        function showTestModal() {
            $('#tcross-modal-title').text('æ¸¬è©¦è¦–çª—');
            var testContent = '<h4>é€™æ˜¯æ¸¬è©¦è¦–çª—</h4>' +
                '<p>é€™å€‹è¦–çª—å±•ç¤ºäº†åŸºæœ¬çš„é¡¯ç¤ºå’Œäº’å‹•åŠŸèƒ½ã€‚</p>' +
                '<ul>' +
                '<li>éŸ¿æ‡‰å¼è¨­è¨ˆ</li>' +
                '<li>æµæš¢å‹•ç•«æ•ˆæœ</li>' +
                '<li>éµç›¤å’Œæ»‘é¼ æ“ä½œæ”¯æ´</li>' +
                '</ul>';
            $('#tcross-modal-content').html(testContent);
            showModal();
            logTest('é¡¯ç¤ºæ¸¬è©¦è¦–çª—');
        }
        
        function showCustomModal() {
            $('#tcross-modal-title').text('è‡ªå®šç¾©å…§å®¹æ¸¬è©¦');
            var customContent = [
                '<div style="text-align: center;">',
                '<h4 style="color: #0073aa;">ğŸ‰ è‡ªå®šç¾©å…§å®¹ç¤ºä¾‹</h4>',
                '<p>é€™è£¡å¯ä»¥æ”¾ç½®ä»»ä½• HTML å…§å®¹ï¼š</p>',
                '<div style="background: #f0f8ff; padding: 15px; border-radius: 5px; margin: 10px 0;">',
                '<strong>é‡è¦æé†’ï¼š</strong><br>',
                'è«‹ç¢ºèªæ‚¨çš„é›»å­éƒµä»¶åœ°å€æ­£ç¢ºï¼Œä»¥ä¾¿æ¥æ”¶é‡è¦é€šçŸ¥ã€‚',
                '</div>',
                '<p style="color: #666; font-size: 14px;">æ”¯æ´åœ–ç‰‡ã€é€£çµã€è¡¨æ ¼ç­‰å„ç¨®å…ƒç´ </p>',
                '</div>'
            ].join('');
            $('#tcross-modal-content').html(customContent);
            showModal();
            logTest('é¡¯ç¤ºè‡ªå®šç¾©å…§å®¹è¦–çª—');
        }
        
        function showSuccessMessage() {
            var successHtml = '<div class="success-box">' +
                '<strong>âœ… è¨»å†ŠæˆåŠŸï¼</strong>' +
                '<p>é€™æ˜¯æ¨¡æ“¬çš„æˆåŠŸè¨Šæ¯ã€‚åœ¨å¯¦éš›æ‡‰ç”¨ä¸­ï¼Œé€™è£¡æœƒé¡¯ç¤ºçœŸæ­£çš„è¨»å†Šçµæœã€‚</p>' +
                '</div>';
            
            $('#test-results').html(successHtml);
            logTest('é¡¯ç¤ºæˆåŠŸè¨Šæ¯', 'success');
        }
        
        function logTest(message, type = 'info') {
            var time = new Date().toLocaleTimeString();
            var color = type === 'error' ? '#dc3232' : type === 'success' ? '#46b450' : '#666';
            var icon = type === 'error' ? 'âŒ' : type === 'success' ? 'âœ…' : 'â„¹ï¸';
            
            console.log(`[${time}] TCross Test: ${message}`);
            
            var logHtml = `<div style="color: ${color}; font-size: 14px; margin: 5px 0;">
                ${icon} [${time}] ${message}
            </div>`;
            
            var currentLogs = $('#test-results').html();
            $('#test-results').html(logHtml + currentLogs);
        }
    </script>
</body>
</html>
